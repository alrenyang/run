<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ - íšŒì› ê´€ë¦¬</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <aside>
        <div class="sidebar-header">
            <a href="index.html">DASHBOARD</a>
        </div>
        <nav>
            <a href="index.html" class="nav-item">
                <span class="nav-icon">ğŸ </span>
                <span>í™ˆ</span>
            </a>
            <a href="members.html" class="nav-item active">
                <span class="nav-icon">ğŸ‘¤</span>
                <span>íšŒì› ê´€ë¦¬</span>
            </a>
            <a href="records.html" class="nav-item">
                <span class="nav-icon">ğŸ“‹</span>
                <span>ê¸°ë¡ í™•ì¸</span>
            </a>
        </nav>
    </aside>

    <main>
        <header>
            <div style="display: flex; align-items: center; justify-content: space-between; width: 100%;">
                <h1>íšŒì› ê´€ë¦¬</h1>
                <button class="btn btn-primary" onclick="openModal()">
                    <span style="font-size: 1.2rem;">+</span> ì¶”ê°€
                </button>
            </div>
        </header>

        <div class="card">
            <h3 style="margin-bottom: 1.25rem;">ëŸ¬ë‹ íšŒì› ëª©ë¡</h3>
            <div style="overflow-x: auto; margin: 0 -1.25rem;">
                <table class="data-table" style="min-width: 600px;">
                    <thead>
                        <tr>
                            <th style="padding-left: 1.25rem;">ID</th>
                            <th>ì´ë¦„</th>
                            <th>ì´ê±°ë¦¬(k)</th>
                            <th>íšŸìˆ˜</th>
                            <th>í˜ì´ìŠ¤</th>
                            <th style="padding-right: 1.25rem; text-align: right;">ê´€ë¦¬</th>
                        </tr>
                    </thead>
                    <tbody id="member-list">
                        <!-- JS ë Œë”ë§ -->
                    </tbody>
                </table>
            </div>
        </div>
    </main>

    <!-- Popup Modal -->
    <div class="modal-overlay" id="modal-overlay" onclick="handleOverlayClick(event)">
        <div class="modal" id="modal-content">
            <div class="modal-header">
                <h3 id="modal-title">íšŒì› ì¶”ê°€</h3>
                <button onclick="closeModal()" style="border:none; background:none; font-size: 1.75rem; cursor:pointer; color: var(--text-muted); padding: 0.5rem;">&times;</button>
            </div>
            <div class="modal-body">
                <form id="member-form" onsubmit="event.preventDefault();">
                    <input type="hidden" id="member-id">
                    <div class="form-group">
                        <label for="name">ì´ë¦„</label>
                        <input type="text" id="name" class="form-control" placeholder="ì„±í•¨ì„ ì…ë ¥í•˜ì„¸ìš”" autocomplete="off">
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                        <div class="form-group">
                            <label for="distance">ì´ê±°ë¦¬ (km)</label>
                            <input type="number" id="distance" class="form-control" placeholder="0.0" step="0.1" autocomplete="off">
                        </div>
                        <div class="form-group">
                            <label for="count">íšŸìˆ˜ (íšŒ)</label>
                            <input type="number" id="count" class="form-control" placeholder="0" autocomplete="off">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="pace">í˜ì´ìŠ¤ (ë¶„'ì´ˆ")</label>
                        <input type="text" id="pace" class="form-control" placeholder="ì˜ˆ: 5'30\"" autocomplete="off">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeModal()">ì·¨ì†Œ</button>
                <button class="btn btn-primary" id="save-btn" onclick="saveMember()">ì €ì¥í•˜ê¸°</button>
            </div>
        </div>
    </div>

    <script>
        let members = JSON.parse(localStorage.getItem('dashboard_running_members')) || [
            { id: 1, name: 'ê¹€ì² ìˆ˜', distance: 125.5, count: 12, pace: "5'10\"" },
            { id: 2, name: 'ì´ì˜í¬', distance: 88.2, count: 8, pace: "6'05\"" },
            { id: 3, name: 'ë°•ì§€ë¯¼', distance: 210.0, count: 20, pace: "4'45\"" }
        ];

        function renderTable() {
            const tbody = document.getElementById('member-list');
            tbody.innerHTML = '';
            
            members.forEach(member => {
                const tr = document.createElement('tr');
                
                tr.innerHTML = `
                    <td style="padding-left: 1.25rem; color: var(--text-muted); font-size: 0.8rem;">#${member.id}</td>
                    <td style="font-weight: 600;">${member.name}</td>
                    <td><span style="font-weight: 700; color: var(--primary-color);">${member.distance}</span> km</td>
                    <td>${member.count} íšŒ</td>
                    <td><span style="background: #f3f4f6; padding: 0.25rem 0.5rem; border-radius: 0.5rem; font-family: monospace;">${member.pace}</span></td>
                    <td style="padding-right: 1.25rem; text-align: right;">
                        <div style="display: flex; gap: 0.4rem; justify-content: flex-end;">
                            <button class="btn btn-outline btn-sm" onclick="editMember(${member.id})">ìˆ˜ì •</button>
                            <button class="btn btn-danger btn-sm" onclick="deleteMember(${member.id})">ì‚­ì œ</button>
                        </div>
                    </td>
                `;
                tbody.appendChild(tr);
            });
            localStorage.setItem('dashboard_running_members', JSON.stringify(members));
        }

        function openModal() {
            document.getElementById('modal-title').innerText = 'íšŒì› ë°ì´í„° ë“±ë¡';
            document.getElementById('save-btn').innerText = 'ë“±ë¡í•˜ê¸°';
            document.getElementById('member-form').reset();
            document.getElementById('member-id').value = '';
            
            const overlay = document.getElementById('modal-overlay');
            overlay.style.display = 'flex';
            setTimeout(() => overlay.classList.add('active'), 10);
        }

        function closeModal() {
            const overlay = document.getElementById('modal-overlay');
            overlay.classList.remove('active');
            setTimeout(() => {
                overlay.style.display = 'none';
            }, 300);
        }

        function handleOverlayClick(e) {
            if(e.target.id === 'modal-overlay') closeModal();
        }

        function saveMember() {
            const id = document.getElementById('member-id').value;
            const name = document.getElementById('name').value;
            const distance = document.getElementById('distance').value;
            const count = document.getElementById('count').value;
            const pace = document.getElementById('pace').value;
            
            if(!name || !distance || !count || !pace) {
                alert('ëª¨ë“  ê¸°ë¡ ì •ë³´ë¥¼ ì •í™•íˆ ì…ë ¥í•´ ì£¼ì„¸ìš”.');
                return;
            }

            if(id) {
                const index = members.findIndex(m => m.id == id);
                members[index] = { ...members[index], name, distance: parseFloat(distance), count: parseInt(count), pace };
            } else {
                const newId = members.length > 0 ? Math.max(...members.map(m => m.id)) + 1 : 1;
                members.push({ id: newId, name, distance: parseFloat(distance), count: parseInt(count), pace });
            }

            renderTable();
            closeModal();
        }

        function editMember(id) {
            const member = members.find(m => m.id === id);
            if(!member) return;

            document.getElementById('modal-title').innerText = 'íšŒì› ê¸°ë¡ ìˆ˜ì •';
            document.getElementById('save-btn').innerText = 'ìˆ˜ì • ì™„ë£Œ';
            document.getElementById('member-id').value = member.id;
            document.getElementById('name').value = member.name;
            document.getElementById('distance').value = member.distance;
            document.getElementById('count').value = member.count;
            document.getElementById('pace').value = member.pace;
            
            const overlay = document.getElementById('modal-overlay');
            overlay.style.display = 'flex';
            setTimeout(() => overlay.classList.add('active'), 10);
        }

        function deleteMember(id) {
            if(confirm('ì´ íšŒì›ì˜ ë°ì´í„°ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\nì‚­ì œëœ ê¸°ë¡ì€ ë³µêµ¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')) {
                members = members.filter(m => m.id !== id);
                renderTable();
            }
        }

        renderTable();
    </script>
</body>
</html>
